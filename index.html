<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Zion Church Lisboa</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/tokens.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <script src="config.js"></script>
    <script src="auth.js"></script>
</head>
<body>
<div class="page-wrapper">

    <!-- BANNER -->
    <div class="banner">
        <img src="banner%20zion.jpg" alt="Zion Lisboa"
             onerror="this.onerror=null;this.style.display='none';document.querySelector('.banner-fallback').classList.add('show');">
        <div class="banner-fallback">
            <div class="banner-title">ZION</div>
            <div class="banner-sub">Lisboa · Portugal</div>
        </div>

        <!-- Hamburger (esquerda) -->
        <button class="hamburger" id="hamburger" onclick="toggleDrawer()" aria-label="Menu">
            <span></span><span></span><span></span>
        </button>

        <!-- Auth bar (direita) -->
        <div class="auth-bar" id="auth-bar"></div>
    </div>

    <!-- Overlay + Drawer lateral -->
    <div class="drawer-overlay" id="drawerOverlay" onclick="closeDrawer()"></div>
    <div class="drawer-nav-panel" id="drawer">
        <div class="drawer-header">
            <div class="drawer-title-panel">Zion Lisboa</div>
            <div class="drawer-sub-panel">Menu de Navegação</div>
        </div>
        <div class="drawer-gold-line"></div>

        <!-- Auth section no drawer -->
        <div class="drawer-auth" id="drawer-auth"></div>

        <nav class="drawer-nav">
            <a href="zion.html"        class="drawer-item" onclick="closeDrawer()"><div class="drawer-icon"></div>Zion Lisboa</a>
            <a href="ministerios.html" class="drawer-item" onclick="closeDrawer()"><div class="drawer-icon"></div>Ministérios</a>
            <a href="links.html"       class="drawer-item" onclick="closeDrawer()"><div class="drawer-icon"></div>Links</a>
            <a href="localizacao.html" class="drawer-item" onclick="closeDrawer()"><div class="drawer-icon"></div>Localização</a>
            <a href="keola.html"       class="drawer-item" onclick="closeDrawer()"><div class="drawer-icon"></div>Keola</a>
            <a href="zao.html"         class="drawer-item" onclick="closeDrawer()"><div class="drawer-icon"></div>ZAO</a>
            <a href="chat.html"        class="drawer-item" onclick="closeDrawer()"><div class="drawer-icon"></div>Chat Assistente</a>
            <a href="membros.html"     class="drawer-item" onclick="closeDrawer()"><div class="drawer-icon"></div>Membros</a>
            <a href="visitantes.html"  class="drawer-item" onclick="closeDrawer()"><div class="drawer-icon"></div>Visitantes</a>
            <a href="dizimos.html"     class="drawer-item" onclick="closeDrawer()"><div class="drawer-icon"></div>Dízimos</a>
            <a href="salas.html"       class="drawer-item" onclick="closeDrawer()"><div class="drawer-icon"></div>Salas</a>
            <a href="aprovacoes.html"  class="drawer-item" onclick="closeDrawer()"><div class="drawer-icon"></div>Aprovação</a>
            <a href="admin.html"       class="drawer-item" onclick="closeDrawer()"><div class="drawer-icon">️</div>Cadastros</a>
        </nav>
        <div class="drawer-footer">
            <div class="drawer-footer-links">
                <a class="drawer-footer-link" href="https://zionchurch.org.br/" target="_blank">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
                    Site
                </a>
                <a class="drawer-footer-link" href="https://www.instagram.com/zionlisboa/" target="_blank">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/></svg>
                    Instagram
                </a>
            </div>
        </div>
    </div>

    <div class="gold-line"></div>

    <!-- MAIN -->
    <div class="main-content">
        <div class="welcome-card">
            <div class="cross-icon">
                <img src="assets/logo_zion.png" alt="Logo Zion Lisboa">
            </div>
            <p><strong>Bem-vindo à Zion Lisboa</strong><br>
                Seleciona uma área abaixo para saber mais sobre a nossa comunidade.</p>
        </div>
        <p class="section-label">O que procuras?</p>
        <div class="grid">
            <a href="zion.html" class="btn-icon">
                <div class="icon-wrap ic-gold"></div>
                <span class="label">Zion</span>
            </a>
            <a href="links.html" class="btn-icon">
                <div class="icon-wrap ic-blue"></div>
                <span class="label">Links</span>
            </a>
            <a href="localizacao.html" class="btn-icon">
                <div class="icon-wrap ic-red"></div>
                <span class="label">Localização</span>
            </a>
            <a href="https://www.bibliaonline.com.br" target="_blank" class="btn-icon">
                <div class="icon-wrap ic-red"></div>
                <span class="label">Bíblia</span>
            </a>
            <a href="chat.html" class="btn-icon btn-icon--wide">
                <div class="icon-wrap ic-gold"></div>
                <span class="label">Chat<br>Assistente Virtual Zion Lisboa</span>
            </a>
        </div>
    </div>

    <!-- FOOTER -->
    <div class="footer">
        <div class="footer-links">
            <a class="footer-link" href="https://zionchurch.org.br/" target="_blank" rel="noopener">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="12" height="12"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
                Site Oficial
            </a>
            <a class="footer-link" href="https://www.instagram.com/zionlisboa/?hl=en" target="_blank" rel="noopener">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="12" height="12"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/></svg>
                @ZionLisboa
            </a>
        </div>
        <div class="footer-div"></div>
        <div class="footer-copy">© 2026 Zion Lisboa — Todos os direitos reservados</div>
        <div class="footer-addr">Rua do Centro Cultural, 11 · 1700-036 Alvalade · Lisboa, Portugal</div>
    </div>
</div>

<script>
    // ── DRAWER ─────────────────────────────────────────────────
    function toggleDrawer() {
        const open = document.getElementById('drawer').classList.toggle('open');
        document.getElementById('drawerOverlay').classList.toggle('open', open);
        document.getElementById('hamburger').classList.toggle('open', open);
    }
    function closeDrawer() {
        document.getElementById('drawer').classList.remove('open');
        document.getElementById('drawerOverlay').classList.remove('open');
        document.getElementById('hamburger').classList.remove('open');
    }
    document.addEventListener('keydown', e => { if (e.key === 'Escape') closeDrawer(); });

    /* === BOTÕES GRID === */
    document.querySelectorAll(".btn-icon").forEach(btn => {
        const label = btn.querySelector(".label").innerText
            .replace(/\n/g, " ")
            .trim();

        const words = label.split(" ").filter(w => w.length > 2);

        let initials = "";

        if (words.length === 1) {
            initials = words[0].substring(0,2);
        } else {
            initials = words[0][0] + words[1][0];
        }

        btn.querySelector(".icon-wrap").textContent = initials.toUpperCase();
    });

    document.querySelectorAll(".drawer-item").forEach(item => {
        const text = item.childNodes[2].textContent.trim();
        const words = text.split(" ");

        let initials = words[0][0];
        if (words.length > 1) {
            initials += words[1][0];
        }

        item.querySelector(".drawer-icon").textContent = initials.toUpperCase();
    });

    // ── AUTH ────────────────────────────────────────────────────
    function renderAuth() {
        const user       = ZionAuth.getUser();
        const authBar    = document.getElementById('auth-bar');
        const drawerAuth = document.getElementById('drawer-auth');
        const tipoLabel  = { visitante: 'Visitante', membro: 'Membro', admin: 'Administrador' };

        if (user) {
            const initials  = (user.nome || 'U').split(' ').map(w => w[0]).slice(0, 2).join('').toUpperCase();
            const firstName = (user.nome || 'Utilizador').split(' ')[0];

            authBar.innerHTML = `
            <div class="auth-user">
                <div class="auth-avatar">${initials}</div>
                <span class="auth-name">${firstName}</span>
            </div>
            <button class="auth-logout" onclick="ZionAuth.logout()">
                <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                Sair
            </button>`;

            drawerAuth.innerHTML = `
            <div class="drawer-auth-logado">
                <div class="drawer-auth-avatar">${initials}</div>
                <div class="drawer-auth-info">
                    <div class="drawer-auth-nome">${user.nome}</div>
                    <div class="drawer-auth-tipo">${tipoLabel[user.tipo] || user.tipo}</div>
                </div>
                <button class="drawer-auth-sair" onclick="ZionAuth.logout()">Sair</button>
            </div>`;
        } else {
            authBar.innerHTML = `
            <a href="login.html" class="auth-login">
                <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/><polyline points="10 17 15 12 10 7"/><line x1="15" y1="12" x2="3" y2="12"/></svg>
                Entrar
            </a>`;

            drawerAuth.innerHTML = `
            <a href="login.html" class="drawer-auth-login" onclick="closeDrawer()">
                <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/><polyline points="10 17 15 12 10 7"/><line x1="15" y1="12" x2="3" y2="12"/></svg>
                Entrar / Registar
            </a>`;
        }
    }

    renderAuth();
</script>
</body>
</html>
